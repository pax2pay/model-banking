import { pax2pay } from "../../../index"

export const card: pax2pay.Rule.State.Evaluated = {
	data: {
		countries: {
			sanctioned: ["IR", "MM", "KP", "RU"],
			eea: [
				"SE",
				"ES",
				"SI",
				"SK",
				"RO",
				"PT",
				"PL",
				"NO",
				"NL",
				"MT",
				"LU",
				"LT",
				"LI",
				"LV",
				"IT",
				"IE",
				"IS",
				"HU",
				"GR",
				"DE",
				"FR",
				"FI",
				"EE",
				"DK",
				"CZ",
				"CY",
				"HR",
				"BG",
				"BE",
				"AT",
			],
			risk: {
				high: [
					"AF",
					"AL",
					"AS",
					"AO",
					"AG",
					"AZ",
					"BS",
					"BD",
					"BB",
					"BY",
					"BZ",
					"BJ",
					"BO",
					"BA",
					"BW",
					"BF",
					"BI",
					"KH",
					"CM",
					"KY",
					"CF",
					"TD",
					"CN",
					"KM",
					"CG",
					"CD",
					"CR",
					"CI",
					"HR",
					"CU",
					"CY",
					"DJ",
					"DO",
					"EC",
					"EG",
					"SV",
					"GQ",
					"ER",
					"ET",
					"GH",
					"GU",
					"GT",
					"GN",
					"GW",
					"HT",
					"HN",
					"IN",
					"ID",
					"IQ",
					"JM",
					"JO",
					"KZ",
					"KE",
					"XK",
					"KW",
					"KG",
					"LA",
					"LB",
					"LS",
					"LR",
					"LY",
					"LI",
					"MO",
					"MK",
					"MG",
					"MV",
					"ML",
					"MH",
					"MR",
					"MU",
					"MX",
					"MD",
					"MC",
					"MN",
					"ME",
					"MA",
					"MZ",
					"NA",
					"NR",
					"NP",
					"NI",
					"NE",
					"NG",
					"PK",
					"PW",
					"PS",
					"PA",
					"PY",
					"PE",
					"PH",
					"PR",
					"WS",
					"SA",
					"SN",
					"RS",
					"SC",
					"SL",
					"SO",
					"ZA",
					"SS",
					"LK",
					"KN",
					"SD",
					"SZ",
					"SY",
					"TJ",
					"TZ",
					"TH",
					"TG",
					"TO",
					"TT",
					"TN",
					"TR",
					"TM",
					"UG",
					"UA",
					"AE",
					"VI",
					"UZ",
					"VU",
					"VE",
					"VN",
					"EH",
					"YE",
					"ZM",
					"ZW",
				],
				mediumHigh: ["DZ", "AR", "AM", "BR", "CV", "CO", "CW", "GA", "GY", "VG"],
			},
		},
		merchant: {
			known: [
				"paxair",
				"paxsino",
				"EASYJET",
				"THAI AIRWAYS INTL PUBLIC",
				"Ryanair",
				"PEGASUS",
				"AER LINGUS",
				"EMIRATES",
				"RYANAIR EURO ECOMM",
				"WIZZ AIR HUNGARY KFT PLN",
				"VUELING AIRLINES",
				"JET2.COM EUR",
				"TUI",
				"PACKAGE POWERSEARCH ON",
				"EUROWINGS",
				"KORAIL 0051147",
				"JET2.COM GBP",
				"Jet2.com FDMS",
				"Jet2.com MOTO",
				"JET2.COM GBP MOTO",
				"WWW.SUNEXPRESS.COM.TR",
				"ITA AIRWAYS",
				"WWW.CORENDONAIRLINES.CO",
				"WIZZ AIR UK LTD- EUR",
				"WWW.SUNEXPRESS.COM",
				"Blue Islands",
				"WIZZ AIR",
				"WIZZ AIRLINES ZRT",
				"WIZZ AIR UK LIMITED",
				"WWW BILKOM PL",
				"www.cd.cz/eshop/",
				"MALAYSIA AIRLIN",
				"WIZZ AIR HUNGARY KFT EUR",
				"Ryanair Head Office",
				"RYANAIR UK DOMESTIC",
				"Air Vistara",
				"TUI TRAVEL-DOM",
				"EASYJET AIRLINE COMPANY L",
				"WIZZ AIR HUNGARY KFT",
				"Saudi Arabian",
				"LOT POLISH AIRL",
				"PEGASUS HAVA TASIMACILI",
				"TURKISH AIRLINE",
				"DELTA AIR LINES",
				"Jet2.com ltd",
				"WIZZ AIR HUF WEB 3DS HUF",
				"TURKISH AIRLIN<ES INC",
			],
			categories: {
				travel: [
					"3301",
					"4011",
					"4111",
					"4112",
					"4121",
					"4131",
					"4411",
					"4511",
					"4511",
					"4582",
					"4722",
					"4789",
					"5045",
					"5499",
					"5732",
					"5812",
					"5813",
					"5816",
					"5941",
					"5962",
					"6513",
					"7011",
					"7012",
					"7033",
					"7230",
					"7298",
					"7311",
					"7372",
					"7399",
					"7512",
					"7523",
					"7922",
					"7941",
					"7991",
					"7992",
					"7996",
					"7997",
					"7999",
					"8220",
					"9399",
					"9402",
					"3308",
					"8398",
					"7832",
					"3000-3299",
					"3351-3500",
					"3501-3999",
				],
				media: [
					"7399",
					"7311",
					"4511",
					"4722",
					"3301",
					"5734",
					"7999",
					"5968",
					"7523",
					"7991",
					"7997",
					"7996",
					"5941",
					"7012",
					"4511",
					"7992",
					"7997",
					"7298",
					"8220",
					"7230",
					"7941",
					"6300",
					"5962",
					"4011",
					"7832",
					"3000-3299",
					"3351-3500",
					"3501-3999",
				],
				payment: [],
				crypto: [],
				gambling: ["7801", "7802"],
				specialist: [],
				sabre: [
					"4511",
					"3301",
					"4722",
					"7523",
					"4411",
					"4111",
					"4789",
					"7991",
					"7011",
					"4112",
					"7512",
					"4121",
					"4131",
					"6513",
					"4582",
					"7996",
					"7997",
					"7298",
					"5941",
					"7032",
					"7999",
					"7311",
					"5734",
					"7922",
					"5962",
					"5734",
					"4511",
					"7992",
					"7997",
					"9402",
					"6300",
					"3000-3299",
					"3351-3500",
					"3501-3999",
				],
			},
		},
	},
	account: {
		name: "upcheck account 2",
		id: "WzauRHBO",
		created: "2023-08-09T16:08:48.309Z",
		rails: [
			{
				type: "paxgiro",
				identifier: "kOXi7IgA",
			},
		],
		balances: {
			GBP: {
				available: 79091531.39,
				reserved: {
					incoming: 0,
					outgoing: 3460736.71,
				},
				actual: 82552268.1,
				incomingReserved: 0,
				outgoingReserved: 3460736.71,
			},
			USD: {
				actual: 301919.12,
				incomingReserved: 676,
				outgoingReserved: -7340,
				reserved: {
					incoming: 676,
					outgoing: -7340,
				},
				available: 308583.12,
			},
		},
		rules: [],
		counterparts: {},
		key: "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEApCMLTSPm/TbZNUfhvq8UgU7KW7LulUu4iZtGrcEiw/ot3Yuv3aRGizi9V2G0Bzh22IduXbjAf5m9N8JiMiuquHdjE0Z5egLK5Wrr8sylbAkArLh9fJshqNFFavJFIk38jSinrz0PH3+Cpx/5TQq1Gnlkl0GebfTx9t0l9/y34w3IH9pXKfxQj2SmlS3qd/g0l6hVySr5nPGbOkEh3zKhK4Qh2GYimv3lck2eGaNB6ct+B2AVswdADQf5D6ToSqmnt0z+aWDUsM9eHbHZh3BMHtpZInDIR8XdwqV9q7mUtDJTv7t1WSBGikjGNMDV/YE2Xp2DUhoggBkGLDfoihrGAH5gUe0w1DYwzEZlscuVkJBDK4cgJHDHX0EM83+5wKGX5Sp40fjq26YVdxR5h+hdJc+DsO8r/md4DNrx6pSSH29e+GnzMI+kePiQ5a+7qUjihD7mTvdFp6ea/e8tvmwarAUHGmAFYjaPY3R2jM5PSX0FiSCflVfhj7mbh0vAIUuNDM1/XUEbTYi0KwF9rkAV0OpfBS8ElrHeII139v4OJsBCfard5P5lbXJoib0Udza1MjzUovzgh5qZ4TBJdKZjucTdYM9NM/xQn4qXeVUxebgyxFks6weSH+8yr5po/gOqS318mj/YrlSE4LNSTRYhol45WAIsG7zChzkCAx4gP4UCAwEAAQ==",
		transactions: {
			today: {
				amount: 12004.379999999997,
				count: 56,
			},
			incoming: {
				today: {
					amount: 0,
					count: 0,
				},
			},
			outgoing: {
				today: {
					amount: 0,
					count: 0,
				},
			},
			card: {
				today: {
					amount: 12829.539999999997,
					count: 58,
				},
			},
		},
		days: {
			currency: 0,
			merchant: {
				name: 0,
				country: 0,
				category: 0,
			},
		},
	},
	transaction: {
		amount: 161,
		currency: "GBP",
		description: "An upcheck test authorization, to succeed. with high realm amount flag.",
		counterpart: {
			type: "card",
			merchant: {
				name: "paxair",
				id: "abcd1234",
				category: "4511",
				country: "GB",
				city: "upcheck town",
				zip: "12345",
				address: "Streetname 1, 12345 Towncity",
			},
			acquirer: {
				id: "2345erty",
				number: "1351858913568",
				country: "GB",
			},
		},
		stage: "initiate",
		kind: "authorization",
		type: "card",
		original: {
			currency: "GBP",
			amount: 161,
			total: 161,
			reserve: 0,
			charge: {
				current: 0,
				total: 0,
			},
		},
		risk: 600,
	},
	authorization: {
		card: "zzzyQLlMt-js_QyO",
		amount: 801,
		merchant: {
			name: "paxair",
			id: "abcd1234",
			category: "4511",
			country: "GB",
			city: "upcheck town",
			zip: "12345",
			address: "Streetname 1, 12345 Towncity",
			reference: "2345erty-abcd1234",
		},
		acquirer: {
			id: "2345erty",
			number: "1351858913568",
			country: "GB",
		},
		description: "An upcheck test authorization, to succeed. with high realm amount flag.",
		reference: "zzzyQLlMrlvjzepy",
		time: "04:48:42.371Z",
		hour: 4,
		currency: "GBP",
	},
	card: {
		account: "WzauRHBO",
		scheme: "mastercard",
		organization: "agpiPo0v",
		realm: "test",
		created: "2024-10-16T04:48:41.618Z",
		details: {
			expiry: [26, 12],
			holder: "Upcheck",
			iin: "111111",
			last4: "3441",
		},
		history: [
			{
				type: "card",
				status: "created",
				created: "2024-10-16T04:48:41.618Z",
			},
		],
		id: "zzzyQLlMt-js_QyO",
		limit: 9000,
		preset: "test-ta-pg-200",
		reference: "zzzyQLlMt-js_QyO",
		rules: [],
		spent: ["GBP", 0],
		status: "active",
		used: {
			count: 0,
			amount: 0,
			merchants: [],
		},
		reject: {
			count: 0,
		},
		age: {
			days: 0,
			minutes: 45,
		},
		original: {
			currency: "GBP",
			limit: 9000,
		},
	},
	organization: {
		name: "upcheck org",
		realm: "test",
		rules: [
			{
				condition: "transaction.risk>250",
				name: "risk checker",
				description: "risk checker tester",
				action: "flag",
				type: "authorization",
				flags: ["category", "daily"],
				code: "risk-checker",
				category: "fincrime",
			},
			{
				condition: "transaction.amount>500",
				name: "score high amount",
				description: "Score tester",
				action: "score",
				risk: 300,
				type: "authorization",
				flags: ["category"],
				code: "score-high-amount",
				category: "fincrime",
			},
			{
				name: "merchant locked card",
				action: "reject",
				type: "authorization",
				condition: "card.used.merchants.length>0 !card.used.merchants:some(authorization.merchant.reference)",
				description: "Card locked to merchant.",
				flags: ["merchant", "count"],
				code: "merchant-locked-card",
				category: "fincrime",
			},
			{
				name: "High amount",
				action: "review",
				type: "outbound",
				condition: "transaction.amount>1000 | transaction.amount<0 - 1000",
				description:
					"Flag outbound transactions for more than 1000 GBP for review (written for forward compatability).",
				flags: ["amount", "high"],
				code: "high-amount",
				category: "fincrime",
			},
			{
				name: "Too High Amount",
				action: "reject",
				type: "authorization",
				condition: "transaction.amount>1000",
				description: "Reject authorizations with an amount above 1000 GBP.",
				flags: ["amount", "too-high"],
				code: "too-high-amount",
				category: "fincrime",
			},
			{
				name: "Daily Amount",
				action: "reject",
				type: "authorization",
				condition: "account.transactions.card.today.amount>100000",
				description: "Reject authorizations when daily total spend amount exceeds 10000 GBP.",
				flags: ["amount", "daily", "too-high"],
				code: "daily-amount",
				category: "fincrime",
			},
			{
				name: "Daily Count",
				action: "reject",
				type: "authorization",
				condition: "account.transactions.card.today.count>1000",
				description: "Reject authorizations when daily total authorization count exceeds 1000.",
				flags: ["daily", "count", "too high"],
				code: "daily-count",
				category: "fincrime",
			},
			{
				name: "High Amount",
				action: "flag",
				type: "authorization",
				condition: "transaction.amount>500",
				description: "Flag authorization with an amount above 500 GBP",
				flags: ["amount", "high"],
				code: "high-amount",
				category: "fincrime",
			},
			{
				name: "Below Limit",
				action: "flag",
				type: "authorization",
				condition: "transaction.amount<0.75*card.limit",
				description: "Flag authorization significantly below limit.",
				flags: ["low", "amount"],
				code: "below-limit",
				category: "fincrime",
			},
		],
		code: "agpiPo0v",
		contact: {
			name: {
				first: "Paul",
				last: "Dirac",
			},
			email: "paul.dirac@spacetime.com",
			phone: {
				code: "+1",
				number: "123456",
			},
			address: {
				primary: {
					countryCode: "AD",
					zipCode: "123456",
					city: "Velocity",
					street: "42 Milkyway",
				},
			},
		},
	},
	outcomes: {},
	outcome: "approve",
	flags: [],
	notes: [],
}
